"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4465],{4137:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>f});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},s="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),s=c(n),d=o,f=s["".concat(p,".").concat(d)]||s[d]||m[d]||a;return n?r.createElement(f,i(i({ref:t},u),{},{components:n})):r.createElement(f,i({ref:t},u))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[s]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<a;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9829:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>s,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var r=n(7462),o=(n(7294),n(4137));const a={sidebar_position:1,title:"1. Build Azure Function"},i=void 0,l={unversionedId:"prodev-5/step-1",id:"prodev-5/step-1",title:"1. Build Azure Function",description:"Working as part of the PrioritZ fusion team you will be configuring a custom connector for a new API you build using Azure Functions. The team has decided to move the logic when a user creates a new \u201cask\u201d to the Azure Function API. This will keep the Power App formula simple and allow more complex logic to be added in the future. In this lab you will create the function, use the Dataverse API, secure the API with Azure AD, configure a custom connector to use the API, and change the Power App to use the connector.",source:"@site/docs/prodev-5/step-1.md",sourceDirName:"prodev-5",slug:"/prodev-5/step-1",permalink:"/Low-Code/docs/prodev-5/step-1",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"1. Build Azure Function"},sidebar:"tutorialSidebar",previous:{title:"3. Use Custom Connector",permalink:"/Low-Code/docs/prodev-4/step-3"},next:{title:"2. Function Implementation",permalink:"/Low-Code/docs/prodev-5/step-2"}},p={},c=[{value:"1.1 Create Azure Function",id:"11-create-azure-function",level:2}],u={toc:c};function s(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("admonition",{title:"LAB SCENARIO",type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Working as part of the PrioritZ fusion team you will be configuring a custom connector for a new API you build using Azure Functions. The team has decided to move the logic when a user creates a new \u201cask\u201d to the Azure Function API. This will keep the Power App formula simple and allow more complex logic to be added in the future. In this lab you will create the function, use the Dataverse API, secure the API with Azure AD, configure a custom connector to use the API, and change the Power App to use the connector."),(0,o.kt)("p",{parentName:"admonition"},"Note: This lab requires an Azure subscription (or trial) in the ",(0,o.kt)("strong",{parentName:"p"},"same tenant")," as your Dataverse environment."),(0,o.kt)("p",{parentName:"admonition"},"In ",(0,o.kt)("strong",{parentName:"p"},"Exercise 1")," you install Azure tools extension for Visual Studio Code and create the function.")),(0,o.kt)("h2",{id:"11-create-azure-function"},"1.1 Create Azure Function"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Launch Visual Studio Code."),(0,o.kt)("li",{parentName:"ol"},"Click Terminal and select New Terminal."),(0,o.kt)("li",{parentName:"ol"},"Go to the terminal and run the command below to create new folder.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"md ContosoFunctions\n")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select Azure Tool and click Sign in to Azure.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"A browser popup should appear. Provide your Azure credentials and login.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Press ",(0,o.kt)("inlineCode",{parentName:"p"},"[CONTROL + SHIFT + P]")," to open the command palette.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Type create new project and select Create new project.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select the ContosoFunctions folder you created and click Select.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select C# for language.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select .NET 6 LTS for .NET runtime.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select HTTP trigger with OpenAPI for template.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enter CreateTopic for function name and ","[ENTER]","."))),(0,o.kt)("ol",{start:13},(0,o.kt)("li",{parentName:"ol"},"Enter Contoso.PrioritZ for namespace and ","[ENTER]"),(0,o.kt)("li",{parentName:"ol"},"Select Anonymous for AccessRights. Later we will protect the function using Azure AD."),(0,o.kt)("li",{parentName:"ol"},"Select Open in current window.")),(0,o.kt)("ol",{start:16},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Your function should open in Visual Studio Code.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click Terminal and select Run Build Task.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"The build should succeed.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Go to terminal and press any key close it."))))}s.isMDXComponent=!0}}]);