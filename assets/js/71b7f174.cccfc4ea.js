"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9747],{4137:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>k});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),p=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},s=function(e){var t=p(e.components);return o.createElement(c.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=p(n),d=r,k=u["".concat(c,".").concat(d)]||u[d]||m[d]||a;return n?o.createElement(k,i(i({ref:t},s),{},{components:n})):o.createElement(k,i({ref:t},s))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[u]="string"==typeof e?e:r,i[1]=l;for(var p=2;p<a;p++)i[p]=n[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6672:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var o=n(7462),r=(n(7294),n(4137));const a={sidebar_position:1,title:"5. Create Custom Connector"},i=void 0,l={unversionedId:"prodev-5/step-5",id:"prodev-5/step-5",title:"5. Create Custom Connector",description:"Working as part of the PrioritZ fusion team you will be configuring a custom connector for a new API you build using Azure Functions. The team has decided to move the logic when a user creates a new \u201cask\u201d to the Azure Function API. This will keep the Power App formula simple and allow more complex logic to be added in the future. In this lab you will create the function, use the Dataverse API, secure the API with Azure AD, configure a custom connector to use the API, and change the Power App to use the connector.",source:"@site/docs/prodev-5/step-5.md",sourceDirName:"prodev-5",slug:"/prodev-5/step-5",permalink:"/Low-Code/docs/prodev-5/step-5",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"5. Create Custom Connector"},sidebar:"tutorialSidebar",previous:{title:"4. Register App",permalink:"/Low-Code/docs/prodev-5/step-4"},next:{title:"1. App Lifecycle Management",permalink:"/Low-Code/docs/prodev-6/step-1"}},c={},p=[{value:"5.1 Create connector",id:"51-create-connector",level:2},{value:"5.2 Test connector",id:"52-test-connector",level:2}],s={toc:p};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,o.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("admonition",{title:"LAB SCENARIO",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Working as part of the PrioritZ fusion team you will be configuring a custom connector for a new API you build using Azure Functions. The team has decided to move the logic when a user creates a new \u201cask\u201d to the Azure Function API. This will keep the Power App formula simple and allow more complex logic to be added in the future. In this lab you will create the function, use the Dataverse API, secure the API with Azure AD, configure a custom connector to use the API, and change the Power App to use the connector."),(0,r.kt)("p",{parentName:"admonition"},"Note: This lab requires an Azure subscription (or trial) in the ",(0,r.kt)("strong",{parentName:"p"},"same tenant")," as your Dataverse environment."),(0,r.kt)("p",{parentName:"admonition"},"In ",(0,r.kt)("strong",{parentName:"p"},"Exercise 5")," you will create a new custom connector.")),(0,r.kt)("h2",{id:"51-create-connector"},"5.1 Create connector"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Navigate to ",(0,r.kt)("a",{parentName:"li",href:"https://portal.azure.com/"},"https://portal.azure.com/")," "),(0,r.kt)("li",{parentName:"ol"},"Select All resources, search for the function app you deployed and click to open it."),(0,r.kt)("li",{parentName:"ol"},"Copy the URL."),(0,r.kt)("li",{parentName:"ol"},"Open a new browser tab or window and paste the URL you copied."),(0,r.kt)("li",{parentName:"ol"},"Add ",(0,r.kt)("inlineCode",{parentName:"li"},"/api/swagger.json")," to the end of the URL and ",(0,r.kt)("inlineCode",{parentName:"li"},"ENTER"))),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},"Click Accept if prompted for permissions."),(0,r.kt)("li",{parentName:"ol"},"Right click on the swagger and select Save as.")),(0,r.kt)("ol",{start:8},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Save the file on your local machine.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to Power Apps maker portal and make sure you have the correct Dev environment selected.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Expand Dataverse and select Custom Connectors.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click on the chevron button next to the New custom connector and select Import an OpenAPI file.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Enter PrioritZ Connector for name and click Import.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the swagger file you saved and click Open.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Continue.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Provide Description and advance to Security."))),(0,r.kt)("ol",{start:16},(0,r.kt)("li",{parentName:"ol"},"Select OAuth 2.0 for Authentication type."),(0,r.kt)("li",{parentName:"ol"},"Select Azure Active Directory Identity provider."),(0,r.kt)("li",{parentName:"ol"},"Copy the PrioritZFL Connector application ID from your notepad and paste it in the Client id field."),(0,r.kt)("li",{parentName:"ol"},"Copy the PrioritZFL Connector Secret your notepad and paste it in the Client secret field."),(0,r.kt)("li",{parentName:"ol"},"Copy the Tenant ID from your notepad and replace common with it in the Tenant ID field."),(0,r.kt)("li",{parentName:"ol"},"Copy the PrioritZ API application ID from your notepad and paste it in the Resource URL field."),(0,r.kt)("li",{parentName:"ol"},"Enter true for Enable on-behalf-of login."),(0,r.kt)("li",{parentName:"ol"},"Click Create connector.")),(0,r.kt)("h2",{id:"52-test-connector"},"5.2 Test connector"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the Test tab.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click + New connection.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Create.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Provide your credentials.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Accept.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select Custom connectors and click Edit on the PrioritZ connector."))),(0,r.kt)("ol",{start:7},(0,r.kt)("li",{parentName:"ol"},"Select the Test tab."),(0,r.kt)("li",{parentName:"ol"},"Make sure the connection you created is selected."),(0,r.kt)("li",{parentName:"ol"},"Turn on Raw Body."),(0,r.kt)("li",{parentName:"ol"},"Provide the JSON below and click Test operation.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'{\n  "topic": "Test Topic",\n  "details": "From Azure Function",\n  "respondBy": "2022-11-01",\n  "myNotes": "It worked",\n  "choices": [\n    {\n      "choice": "Choice 1"\n    }\n  ]\n}\n')),(0,r.kt)("ol",{start:11},(0,r.kt)("li",{parentName:"ol"},"The operation test should succeed, and the response should look like the image below.")))}u.isMDXComponent=!0}}]);