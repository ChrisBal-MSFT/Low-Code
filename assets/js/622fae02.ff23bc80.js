"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4477],{4137:(e,t,a)=>{a.d(t,{Zo:()=>s,kt:()=>k});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var p=n.createContext({}),c=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},s=function(e){var t=c(e.components);return n.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=c(a),d=o,k=u["".concat(p,".").concat(d)]||u[d]||m[d]||r;return a?n.createElement(k,i(i({ref:t},s),{},{components:a})):n.createElement(k,i({ref:t},s))}));function k(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<r;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},1493:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var n=a(7462),o=(a(7294),a(4137));const r={sidebar_position:1,title:"3. Publish to Azure"},i=void 0,l={unversionedId:"prodev-6/step-3",id:"prodev-6/step-3",title:"3. Publish to Azure",description:"Working as part of the PrioritZ fusion team you will be configuring a custom connector for a new API you build using Azure Functions. The team has decided to move the logic when a user creates a new \u201cask\u201d to the Azure Function API. This will keep the Power App formula simple and allow more complex logic to be added in the future. In this lab you will create the function, use the Dataverse API, secure the API with Azure AD, configure a custom connector to use the API, and change the Power App to use the connector.",source:"@site/docs/prodev-6/step-3.md",sourceDirName:"prodev-6",slug:"/prodev-6/step-3",permalink:"/Low-Code/docs/prodev-6/step-3",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"3. Publish to Azure"},sidebar:"tutorialSidebar",previous:{title:"2. Configure Service Principal",permalink:"/Low-Code/docs/prodev-6/step-2"},next:{title:"4. Export and Branch",permalink:"/Low-Code/docs/prodev-6/step-4"}},p={},c=[{value:"3.1 Publish to Azure",id:"31-publish-to-azure",level:2}],s={toc:c};function u(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,n.Z)({},s,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("admonition",{title:"LAB SCENARIO",type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Working as part of the PrioritZ fusion team you will be configuring a custom connector for a new API you build using Azure Functions. The team has decided to move the logic when a user creates a new \u201cask\u201d to the Azure Function API. This will keep the Power App formula simple and allow more complex logic to be added in the future. In this lab you will create the function, use the Dataverse API, secure the API with Azure AD, configure a custom connector to use the API, and change the Power App to use the connector."),(0,o.kt)("p",{parentName:"admonition"},"Note: This lab requires an Azure subscription (or trial) in the ",(0,o.kt)("strong",{parentName:"p"},"same tenant")," as your Dataverse environment."),(0,o.kt)("p",{parentName:"admonition"},"In ",(0,o.kt)("strong",{parentName:"p"},"Exercise 3")," you will deploy the function to Azure.")),(0,o.kt)("h2",{id:"31-publish-to-azure"},"3.1 Publish to Azure"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Press ","[CONTROL + SHIFT + P]"," to open the command palette."),(0,o.kt)("li",{parentName:"ol"},"Type create function and select Create Function App in Azure."),(0,o.kt)("li",{parentName:"ol"},"Select + Create Function App."),(0,o.kt)("li",{parentName:"ol"},"Enter PrioritZFuncFL for function app name an ","[ENTER]",". Replace FL with your initials."),(0,o.kt)("li",{parentName:"ol"},"Select .NET 6."),(0,o.kt)("li",{parentName:"ol"},"Select your location."),(0,o.kt)("li",{parentName:"ol"},"Wait for the function app to be created."),(0,o.kt)("li",{parentName:"ol"},"Click Deploy and select Deploy to Function App.")),(0,o.kt)("ol",{start:9},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select the function you created.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click Deploy and wait for the deployment to complete.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Navigate to ",(0,o.kt)("a",{parentName:"p",href:"https://portal.azure.com/"},"https://portal.azure.com/")," ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select All resources, search for the function app you deployed and click to open it.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select Authentication and click Add identity provider.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select Microsoft for Identity provider, ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select Current tenant - Single tenant and click Add."))),(0,o.kt)("ol",{start:16},(0,o.kt)("li",{parentName:"ol"},"Go to the Portal menu page of Azure portal."),(0,o.kt)("li",{parentName:"ol"},"Select Azure Active Directory.")),(0,o.kt)("ol",{start:18},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select App registrations.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click to open the ",(0,o.kt)("inlineCode",{parentName:"p"},"PrioritFuncZFL"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Copy the Application (client) ID of the PrioritZFuncFL application registration and keep it on a notepad as PrioritZFL API application ID. You will need this id in future steps.  This ID will be used to configure protection of the API.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Copy the Directory (tenant) ID and keep it on a notepad as Tenant ID. You will need this id in future steps.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select Certificates & secrets.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click New + client secret."))),(0,o.kt)("ol",{start:24},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Provide a description, select 3 months, and click Add.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Copy the Value and keep it in a notepad as PrioritZFL API Secret. You need this value in future steps.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select API permissions.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click + Add a permission."))),(0,o.kt)("ol",{start:28},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select Dynamics CRM. Dynamics CRM is Dataverse, the Azure portal just hasn\u2019t been updated as of the time of the writing of these steps.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Check the user_impersonation checkbox and click Add permission.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Go back to Home and open the PrioritZFL function app.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select Configuration.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click + New application setting.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enter ClientID for Name.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Go to your notepad and copy the PrioritZFL API application ID.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Go back to the portal, paste the ID you copied in the Value field, and click OK."))),(0,o.kt)("ol",{start:36},(0,o.kt)("li",{parentName:"ol"},"Click + New application setting again."),(0,o.kt)("li",{parentName:"ol"},"Enter ClientSecret for Name."),(0,o.kt)("li",{parentName:"ol"},"Go to your notepad and copy the PrioritZFL API Secret."),(0,o.kt)("li",{parentName:"ol"},"Go back to the portal, paste the secret you copied in the Value field, and click OK."),(0,o.kt)("li",{parentName:"ol"},"Click + New application setting again."),(0,o.kt)("li",{parentName:"ol"},"Enter TenantID for Name."),(0,o.kt)("li",{parentName:"ol"},"Go to your notepad and copy the Tenant ID."),(0,o.kt)("li",{parentName:"ol"},"Go back to the portal, paste the Tenant ID you copied in the Value field, and click OK."),(0,o.kt)("li",{parentName:"ol"},"Click + New application setting one more time."),(0,o.kt)("li",{parentName:"ol"},"Enter DataverseURL for Name."),(0,o.kt)("li",{parentName:"ol"},"Start a new browser window or tab and navigate to Power Platform admin center  and select Environments."),(0,o.kt)("li",{parentName:"ol"},"Click to open the Dev environment you are using for this lab."),(0,o.kt)("li",{parentName:"ol"},"Copy the Environment URL.")),(0,o.kt)("ol",{start:49},(0,o.kt)("li",{parentName:"ol"},"Go back to the portal, paste the URL you copied in the Value field, and click OK."),(0,o.kt)("li",{parentName:"ol"},"You should see the four application settings you added. Click Save.")),(0,o.kt)("ol",{start:51},(0,o.kt)("li",{parentName:"ol"},"Click Continue."),(0,o.kt)("li",{parentName:"ol"},"Navigate to ",(0,o.kt)("a",{parentName:"li",href:"https://login.microsoftonline.com/%7Btenant"},"https://login.microsoftonline.com/{tenant")," id}/adminconsent?client_id={api app id} Replace {tenant id} and {api app id} with tenant id and PrioritZFL API application ID from your notepad. If you are not a tenant administrator, you will need to work with your trainer/administrator to consent. You can provide them the link to speed up the process."),(0,o.kt)("li",{parentName:"ol"},"Click Accept.")))}u.isMDXComponent=!0}}]);